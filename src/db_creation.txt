CREATE TABLE Veicolo (
    telaio INT PRIMARY KEY,
    marca VARCHAR(100),
    modello VARCHAR(100),
    dataProd DATE
);

CREATE TABLE Targa (
    numero VARCHAR(20) PRIMARY KEY,
    dataEm DATE
);

CREATE TABLE TargaAttiva (
    targa VARCHAR(20) PRIMARY KEY,
    veicolo INT,  -- Chiave esterna verso Veicolo
    FOREIGN KEY (targa) REFERENCES Targa(numero),
    FOREIGN KEY (veicolo) REFERENCES Veicolo(telaio)
);

CREATE TABLE TargaRestituita (
    targa VARCHAR(20),
    veicolo INT,  -- Chiave esterna verso Veicolo
    dataRes DATE,
    FOREIGN KEY (targa) REFERENCES Targa(numero),
    FOREIGN KEY (veicolo) REFERENCES Veicolo(telaio)
);

CREATE TABLE Revisione (
    numeroRevisione INT PRIMARY KEY,
    numeroTarga VARCHAR(20),
    dataRev DATE,
    esito ENUM('positivo', 'negativo'),
    motivazione TEXT,
    FOREIGN KEY (numeroTarga) REFERENCES Targa(numeroTarga),
    CONSTRAINT check_revisione_esito_motivazione 
        CHECK (
            (esito = 'positivo' AND motivazione IS NULL)
            OR
            (esito = 'negativo' AND motivazione IS NOT NULL)
        )
);